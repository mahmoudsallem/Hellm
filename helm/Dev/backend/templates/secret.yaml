apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: app-secret
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "backend.labels" . | nindent 4 }}
spec:
  # IMPORTANT: encryptedData values must be sealed using kubeseal
  # To seal: echo -n 'value' | kubeseal --raw --namespace <namespace> --name app-secret
  encryptedData:
    # PostgreSQL username - Sealed from .Values.secrets.postgresUser
    POSTGRES_USER: {{ .Values.secrets.postgresUserSealed | quote }}
    # PostgreSQL password - Sealed from .Values.secrets.postgresPassword
    POSTGRES_PASSWORD: {{ .Values.secrets.postgresPasswordSealed | quote }}
  template:
    type: Opaque
    metadata:
      name: app-secret
      namespace: {{ .Values.namespace }}
      labels:
        {{- include "backend.labels" . | nindent 8 }}
